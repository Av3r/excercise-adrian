<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0069)https://sdkp.pjwstk.edu.pl/html/staskshtml/S_MODELING/S_MODELING.html -->
<html><script type="text/javascript" src="chrome-extension://kajfghlhfkcocafkcjlajldicbikpgnp/catcher.js"><!-- script injected by Request Maker --></script><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
  <title>S_MODELING</title><link rel="stylesheet" id="coToolbarStyle" href="chrome-extension://cjabmdjcfcfdmffimndhafhblfmpjdpe/toolbar/styles/placeholder.css" type="text/css"><script type="text/javascript" id="cosymantecbfw_removeToolbar">(function () {				var toolbarElement = {},					parent = {},					interval = 0,					retryCount = 0,					isRemoved = false;				if (window.location.protocol === 'file:') {					interval = window.setInterval(function () {						toolbarElement = document.getElementById('coFrameDiv');						if (toolbarElement) {							parent = toolbarElement.parentNode;							if (parent) {								parent.removeChild(toolbarElement);								isRemoved = true;								if (document.body && document.body.style) {									document.body.style.setProperty('margin-top', '0px', 'important');								}							}						}						retryCount += 1;						if (retryCount > 10 || isRemoved) {							window.clearInterval(interval);						}					}, 10);				}			})();</script></head>
<body><h2 style="text-align: center;">Zadanie: �rodowisko modelowania</h2>Zadanie obejmuje material, dotycz�cy: refleksji, adnotacji i skrypt�w.<br>W pe�nej wersji to zadanie stanowi ma�y projekt.<br>Dlatego na pocz�tku zostan� przedstawione obja�nienia.<br>Na ko�cu sformu�owane jest samo zadanie do wykonania - <a href="https://sdkp.pjwstk.edu.pl/html/staskshtml/S_MODELING/S_MODELING.html#zad">ZOBACZ</a>.<br>oraz wa�na uwaga nt oprogramowania skryptow - <a href="https://sdkp.pjwstk.edu.pl/html/staskshtml/S_MODELING/S_MODELING.html#spom">SKRYPTY POMOC</a><br><span style="font-weight: bold;"></span><hr style="width: 100%; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">Obja�nienia</span><br><span style="font-weight: bold;"></span></div><span style="font-weight: bold;"><br>1. Za�o�enia og�lne</span><br><br>W klasach umieszczonych w pakiecie <span style="font-weight: bold;">models</span> zdefiniowano modele symulacyjne, wykonuj�ce jakie� obliczenia dla okres�w (np. lat)<br>Definicja modelu zawiera:<br><ol><li>pole o nazwie LL,&nbsp;oznaczaj�ce liczb� lat symulacji,</li><li>pola oznaczaj�ce zmienne modelu - s� to tablice liczb rzeczywistych.</li><li>ew. pola pomocnicze</li><li>metod� public void run(), wykonuj�ca obliczenia.</li><li>ew. inne metody pomocnicze.</li></ol>Pola 1 i 2 s� oznaczane adnotacj� @Bind, co umozliwia:<br>- nadanie warto�ci zmiennym wej�ciowym modelu przed wykonaniem oblicze�,<br>- pobranie warto�ci zmiennych wyliczonych w modelu (po wykonaniu oblicze�).<br><br>Wszystkie
zmienne oznaczone adnotacj� @Bind s� dost�pne dla skrypt�w, kt�re mog�
by� uruchamiane po wykonaniu obliczen modelowych i &nbsp;wykonywa�
jakie� dalsze obliczenia.<br>S� tak�e dost�pne dla ew. innych modeli.<br><br>Zarz�dzaniem obliczeniami zajmuje si� klasa <span style="font-weight: bold;">Controller</span>, kt�ra ma nast�puj�ce publiczne sk�adowe:<br><ul><li>konstruktor - Controller(String modelName) - parametrem jest tu nazwa klasy modelu,</li><li>Controller readDataFrom(String fname) - wczytuje dane do oblicze� z &nbsp;pliku o nazwie fname.</li><li>Controller runModel() - uruchamia obliczenia modelowe,</li><li>Controller runScriptFromFile(String fname) &nbsp;- wykonuje skrypt z pliku o nazwie fname,</li><li>Controller runScript(String script) - wykonuje kod skryptu podany jako napis, </li><li>String
getResultsAsTsv() - zwraca wyniki oblicze� (wszystkie zmienne z modelu
oraz zmienne utworzone w skryptach) w postaci &nbsp;napisu, kt�rego
kolejne wiersze zawieraj� nazw� zmiennej i jej wartosci, rozdzielone
znakami tabulacji.</li></ul><span style="font-weight: bold;">2. &nbsp;Za�o�enia co do danych wej�ciowych</span><br><br>Pliki z danymi wej�ciowymi zawieraj� w kolejnych wierszach dane w postaci:<br><br><span style="font-style: italic;">nazwa_zmiennej warto��1 &nbsp;[ warto��2 ... warto�cN ]</span><br><br>Specjalny wiersz zaczynaj�cy si� s�owem&nbsp; LATA specyfikuje lata oblicze�, np.<br>LATA&nbsp; 2015 2016 2017 2018 2019<br><br>Na
podstawie tego wiersza definiowana jest warto�� specjalnej zmiennej LL
(liczba lat oblicze�), dostepnej w modelu i w skryptach.<br><br>Warto�ci dla zmiennych mo�e by� od 1 do LL.<br>Jesli jest ich mniej ni� LL, to pozosta�e s� ustalane na ostatni� z podanych warto�ci.<br><br><span style="font-weight: bold;">3. Przyk�ad</span><br><br>Mamy nast�puj�cy model:<br><pre>public class Model1 {<br>  <br>  @Bind private int LL; // liczba lat<br>  <br>  @Bind private  double[] twKI; // tempo wzrostu kons.ind.<br>  @Bind private  double[] twKS; // tempo wzrostu kons.spo�.<br>  @Bind private  double[] twINW; // tempo wzrostu inwestycji<br>  @Bind private  double[] twEKS; // tempo wzrostu eksportu<br>  @Bind private  double[] twIMP; // tempo wzrostu importu<br><br>  <br>  @Bind private double[] KI;  // kons.ind.<br>  @Bind private double[] KS;  // kons.spo�eczna<br>  @Bind private double[] INW;  // inwestycje.<br>  @Bind private double[] EKS;  // eksport<br>  @Bind private double[] IMP;  // import.<br>  @Bind private double[] PKB;  // PKB<br>  <br>  private double temp; // pole nie zwi�zane z danymi dla modelu ani jego wynikami<br>  <br>  public Model1() {}<br>  <br>  public void run() {<br>    PKB = new double[LL];<br>    PKB[0] = KI[0] + KS[0] + INW[0] + EKS[0] - IMP[0];<br>    for (int t=1; t &lt; LL; t++) {<br>      KI[t] = twKI[t]* KI[t-1];<br>      KS[t] = twKS[t]* KS[t-1];<br>      INW[t] = twINW[t]* INW[t-1];<br>      EKS[t] = twEKS[t]* EKS[t-1];<br>      IMP[t] = twIMP[t]* IMP[t-1];<br>      PKB[t] = KI[t] + KS[t] + INW[t] + EKS[t] - IMP[t];<br>    }<br>  }<br>}</pre>Dla pliku data1.txt o nast�puj�cej postaci::<br><pre>LATA	2015 2016 2017 2018 2019<br>twKI	1.03<br>twKS	1.04<br>twINW	1.12<br>twEKS	1.13<br>twIMP	1.14<br>KI	1023752.2<br>KS	315397<br>INW	348358<br>EKS	811108.6<br>IMP	784342.4</pre>nast�puj�cy fragment programu g��wnego:<br><pre>    Controller ctl = new Controller("Model1");<br>    ctl.readDataFrom(dataDir + "data1.txt") <br>                    .runModel()<br>    String res= ctl.getResultsAsTsv();<br>    System.out.println(res);<br></pre>wypisze na konsoli:<br><pre>LATA	2015	2016	2017	2018	2019<br>twKI	1.03	1.03	1.03	1.03	1.03<br>twKS	1.04	1.04	1.04	1.04	1.04<br>twINW	1.12	1.12	1.12	1.12	1.12<br>twEKS	1.13	1.13	1.13	1.13	1.13<br>twIMP	1.14	1.14	1.14	1.14	1.14<br>KI	1023752.2	1054464.766	1086098.70898	1118681.6702494002	1152242.1203568822<br>KS	315397.0	328012.88	341133.3952	354778.73100800003	368969.88024832006<br>INW	348358.0	390160.96	436980.2752000001	489417.90822400013	548148.0572108802<br>EKS	811108.6	916552.7179999999	1035704.5713399998	1170346.1656141996	1322491.1671440455<br>IMP	784342.4	894150.3359999999	1019331.3830399998	1162037.7766655996	1324723.0653987834<br>PKB	1714273.4	1795040.9880000001	1880585.5676800003	1971186.6984300003	2067128.1595613444<br></pre>a dla pliku data2.txt, wygl�daj�cego tak:<br><pre>LATA	2015 2016 2017 2018 2019<br>twKI	1.03 1.05 1.07<br>twKS	1.04<br>twINW	1.12<br>twEKS	1.13<br>twIMP	1.14<br>KI	1023752.2<br>KS	315397<br>INW	348358<br>EKS	811108.6<br>IMP	784342.4</pre><br><br>uzyskamy po <br><pre>ctl.readDataFrom(dataDir + "data2.txt").runModel()</pre>wynik:<br><pre>LATA	2015	2016	2017	2018	2019<br>twKI	1.03	1.05	1.07	1.07	1.07<br>twKS	1.04	1.04	1.04	1.04	1.04<br>twINW	1.12	1.12	1.12	1.12	1.12<br>twEKS	1.13	1.13	1.13	1.13	1.13<br>twIMP	1.14	1.14	1.14	1.14	1.14<br>KI	1023752.2	1074939.81	1150185.5967	1230698.5884690003	1316847.4896618305<br>KS	315397.0	328012.88	341133.3952	354778.73100800003	368969.88024832006<br>INW	348358.0	390160.96	436980.2752000001	489417.90822400013	548148.0572108802<br>EKS	811108.6	916552.7179999999	1035704.5713399998	1170346.1656141996	1322491.1671440455<br>IMP	784342.4	894150.3359999999	1019331.3830399998	1162037.7766655996	1324723.0653987834<br>PKB	1714273.4	1815516.032	1944672.4554000003	2083203.6166496002	2231733.528866293<br></pre><span style="font-weight: bold;">4. Skrypty</span><br><br>Skrypty
naj�atwiej b�dzie pisa� w j�zyku Groovy. W skryptach maj� by� dost�pne
wszystkie wczytane dane oraz &nbsp;dane z modelu (ale tylko oznaczone
przez @Bind).<br>Zmienne utworzone w skrypcie maj� by� dost�pne zar�wno
w wynikowym tsv, jak i w ew. innych modelach (o ile wyst�puj� tam
&nbsp;jako pola oznaczone przez @Bind), a tak�e innych skryptach.
Wyj�tkiem od tej regu�y s� zmienne&nbsp;o jednoliterowych nazwach
&nbsp;pisanych ma�� liter� (np. i, j k, p) - te zmienne nie b�d�
widoczne w wynikach ani dost�pne w modelach czy innych skryptach.<br><br>Przyk�adowy
skrypt, zapisany w pliku script1.groovy&nbsp; mo�e wygl�da� tak
(obliczany tu jest wska�nik tzw. zdolno�ci eksportowej):<br><pre>ZDEKS = new double[LL]<br>for (i = 0; i &lt; LL; i++) {<br>  ZDEKS[i] =  EKS[i]/PKB[i];<br>}</pre>Uwaga:
w tym skrypcie dost�pna jest zmienna LL, oznaczaj�ca liczb� lat oraz
zmienne powsta�e w wyniku obliczen modelowych (PKB i EKS). Skrypt
tworzy nowe zmienne ZDEKS oraz i, ale tylko ZDEKS b�dzie &nbsp;widoczna
w wynikach i dost�pna dla innych modeli i skrypt�w.<br><br>Przyk�adowe wywo�anie:<br><pre>    Controller ctl = new Controller("Model1");<br>    ctl.readDataFrom(dataDir + "data2.txt") <br>                    .runModel()<br>                    .runScriptFromFile(scriptDir + "script1.groovy");<br>    String res= ctl.getResultsAsTsv();<br>    System.out.println(res);<br></pre>wypisze:<br><br><pre>LATA	2015	2016	2017	2018	2019<br>twKI	1.03	1.05	1.07	1.07	1.07<br>twKS	1.04	1.04	1.04	1.04	1.04<br>twINW	1.12	1.12	1.12	1.12	1.12<br>twEKS	1.13	1.13	1.13	1.13	1.13<br>twIMP	1.14	1.14	1.14	1.14	1.14<br>KI	1023752.2	1074939.81	1150185.5967	1230698.5884690003	1316847.4896618305<br>KS	315397.0	328012.88	341133.3952	354778.73100800003	368969.88024832006<br>INW	348358.0	390160.96	436980.2752000001	489417.90822400013	548148.0572108802<br>EKS	811108.6	916552.7179999999	1035704.5713399998	1170346.1656141996	1322491.1671440455<br>IMP	784342.4	894150.3359999999	1019331.3830399998	1162037.7766655996	1324723.0653987834<br>PKB	1714273.4	1815516.032	1944672.4554000003	2083203.6166496002	2231733.528866293<br>ZDEKS	0.47315008212808995	0.5048441885640148	0.5325856127925489	0.561801139485567	0.5925847105123984<br></pre><span style="font-weight: bold;">5. &nbsp;GUI</span><br><br>Dodatkowe punkty (ponad ustalone max) mo�na uzyskac za przygotowanie GUI do dzia�ania z modelami i skryptami.<br>Oto ad hoc przygotowany przyk�ad takiego interfejsu.<br><img style="width: 736px; height: 340px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys1.jpg"><br><br>Po naci�ni�ciu "Run model":<br><br><img style="width: 736px; height: 340px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys2.jpg"><br><br>Uwaga: prosz� zwr�ci� uwag� na formatowanie liczb<br><br>Mo�na teraz wybra� skrypt z pliku:<br><img style="width: 880px; height: 653px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys3.jpg"><br><br>i od razu zobaczy� dodatkowy wynik:<br><img style="width: 900px; height: 343px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys4.jpg"><br><br>albo wybra� "Create and run ad hoc script" aby wpisa� kod skryptu:<br><img style="width: 514px; height: 408px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys5.jpg">&nbsp;<br>i od razu uzyskac wynik:<br><br><img style="width: 736px; height: 384px;" alt="r" src="../../../../../../../Desktop/S_MODELING_files/rys6.jpg"><br><span style="font-weight: bold;"><br><br>6. Dodatkowe w�a�ciwo�ci</span><br><br>Warto pomy�le� nad tym jak upro�cic pisanie skrypt�w. Np. zamiast:<br><pre>DPKB = new double[LL]<br>for (t = 0; t &lt; LL; t++) {<br>  DPKB[t] = PKB[t]/PKB[0]*100<br>}</pre>chcieliby�my pisa� tak:<br><br><pre>DPKB = PKB/PKB[0]</pre><br>To nie jest trudne. Procentuje dodatkowymi punktami ponad max.<br><hr style="width: 100%; height: 2px;"><br><a name="zad"></a>I wreszcie ....<br><div style="text-align: center;"><span style="font-weight: bold;">Zadanie do wykonania</span><br></div><br>Maj�c wygenerowany projekt z klas� Main oraz models.Model1, a tak�e plik z danymi wej�ciowymi data1.txt:<br><pre>LATA	2015 2016 2017 2018 2019<br>twKI	1.03<br>twKS	1.04<br>twINW	1.12<br>twEKS	1.13<br>twIMP	1.14<br>KI	1023752.2<br>KS	315397<br>INW	348358<br>EKS	811108.6<br>IMP	784342.4</pre>oraz plik skryptu script1.groovy:<br><br><pre>ZDEKS = new double[LL]<br>for (i = 0; i &lt; LL; i++) {<br>  ZDEKS[i] =  EKS[i]/PKB[i];<br>}</pre>zdefinowa� adnotacj� @Bind oraz klas� Controller w taki spos�b, aby poni�szy program:<br><br><pre>public class Main {<br><br>  public static void main(String[] args) {<br>    String dataDir = System.getProperty("user.home") + "/Modeling/data/";<br>    String scriptDir = System.getProperty("user.home") + "/Modeling/scripts/";<br>    Controller ctl = new Controller("Model1");<br>    ctl.readDataFrom(dataDir + "data2.txt") <br>                    .runModel()<br>                    .runScriptFromFile(scriptDir + "script1.groovy");<br>    String res= ctl.getResultsAsTsv();<br>    System.out.println(res);<br>  }<br>}</pre>wyprowadzi� na konsol�:<br><pre>LATA	2015	2016	2017	2018	2019<br>twKI	1.03	1.05	1.07	1.07	1.07<br>twKS	1.04	1.04	1.04	1.04	1.04<br>twINW	1.12	1.12	1.12	1.12	1.12<br>twEKS	1.13	1.13	1.13	1.13	1.13<br>twIMP	1.14	1.14	1.14	1.14	1.14<br>KI	1023752.2	1074939.81	1150185.5967	1230698.5884690003	1316847.4896618305<br>KS	315397.0	328012.88	341133.3952	354778.73100800003	368969.88024832006<br>INW	348358.0	390160.96	436980.2752000001	489417.90822400013	548148.0572108802<br>EKS	811108.6	916552.7179999999	1035704.5713399998	1170346.1656141996	1322491.1671440455<br>IMP	784342.4	894150.3359999999	1019331.3830399998	1162037.7766655996	1324723.0653987834<br>PKB	1714273.4	1815516.032	1944672.4554000003	2083203.6166496002	2231733.528866293<br>ZDEKS	0.47315008212808995	0.5048441885640148	0.5325856127925489	0.561801139485567	0.5925847105123984<br></pre>Specyfikacje u�ytych metod klasy Controller podano w p. 1 obja�nie�.<br><br>Plik�w
Main.java oraz Model1.java nie wolno modyfikowa�. Umiejscowienie plik�w
data1.txt i script1.groovy jest okreslone przez metod� main klasy Main.<br>Przygotowa�
program tak, aby dzia�a� dla innych modeli i danych oraz innych
skrypt�w. Aby to przetestowac mo�na stworzy� dodatkowe klasy w pakiecie.<br><br>Dodatkowe punkty ponad max uzyskujemy za:<br><ul><li>przygotowanie GUI (zob. p. 5 obja�nie�)</li><li>u�atwienia w pisaniu skrypt�w&nbsp; (zob. p. 6 obja�nie�)</li></ul><br><hr style="width: 100%; height: 2px;"><span style="font-weight: bold;"><a name="spom"></a>Skrypty - pomoc</span><br><br>Skrypty piszemy w j�zyku Groovy bo pisa� mozna tak samo jak w Javie, a dodatkowo jest b. du�o u�atwie�.<br>Aby&nbsp;m�g�
&nbsp;by� odnaleziony Script Engine groovy'ego na �cie�ce CLASSPATH (w
Eclipse - Buildpath) musi by� umieszczony groovy-all -x.x.x.jar<br>np. groovy-all-2.4.5.jar &nbsp;(mo�na go wzi�� z katalogu P:\FTP(Public)\kb\UTP\Cwiczenia)..<br><br>JAR
nalezy umie�ci� w zewn�trznym wobec projektu &nbsp;katalogu (np.
C\'ExtLib) i poda� go pod "External JAR files" w Buildpath Configure.<br><span style="color: rgb(1, 0, 0); font-weight: bold;">Nie przysylamy JARow z projektem!</span><br><br><br>
</body><div id="coFrameDiv" style="height:0px;display:none;"><iframe id="coToolbarFrame" src="../../../../../../../Desktop/S_MODELING_files/placeholder.html" style="height: 0px; width: 100%; display: none;"></iframe></div></html>